<?php
/*   __________________________________________________
    |  Obfuscated by YAK Pro - Php Obfuscator  2.0.14  |
    |              on 2024-08-02 12:47:56              |
    |    GitHub: https://github.com/pk-fr/yakpro-po    |
    |__________________________________________________|
*/

namespace Fuwafuwa\Traits;

trait Content
{
    function expire_header(string $O003229874, int $O106538204) : void
    {
        header("\114\x61\x73\x74\55\115\x6f\x64\151\x66\151\145\x64\x3a\x20" . gmdate(DATE_RFC822, strtotime($O003229874)));
        $O753075079 = gmdate(DATE_RFC822, time() + $O106538204);
        header("\105\x78\160\151\x72\145\x73\x3a\x20{$O753075079}");
        header("\120\162\x61\x67\155\141\x3a\x20\x63\141\x63\x68\145");
        header("\103\x61\143\x68\x65\55\x43\157\156\x74\162\x6f\154\72\x20\155\x61\170\55\141\x67\x65\75{$O106538204}");
    }
    function escape_pointer(string $O483065929) : string
    {
        return preg_replace_callback("\57\134\173\176\x2e\x2a\x3f\176\175\57", function (array $O303733380) {
            return str_replace(["\46\154\164\x3b", "\46\x67\164\x3b"], ["\74", "\76"], $O303733380[0]);
        }, $O483065929);
    }
    function content_image(string $O483065929) : string
    {
        $O673402283 = \Base::instance();
        if (preg_match("\x2f\x3c\x69\x6d\147\x2e\52\77\163\x72\x63\75\x22\50\x2e\x2a\77\x29\42\57", $O483065929, $O512437967)) {
            goto O109398963;
        }
        if (preg_match("\x2f\x65\x6d\142\x65\x64\x5c\x2f\x28\x2e\x2a\x3f\x29\x5c\x3f\x2f", $O483065929, $O512437967)) {
            goto O677558273;
        }
        $O087924992 = '';
        goto O334848913;
        O109398963:
        $O087924992 = $O512437967[1];
        if (preg_match("\x2f\136\x68\x74\164\x70\57", $O087924992)) {
            goto O239027325;
        }
        $O087924992 = $O673402283["\123\103\x48\105\115\x45"] . "\72\x2f\x2f" . $O673402283["\110\117\123\x54"] . $O087924992;
        O239027325:
        goto O334848913;
        O677558273:
        $O087924992 = "\150\164\164\x70\163\x3a\x2f\57\151\x31\x2e\171\164\151\155\x67\56\143\x6f\x6d\57\166\151\57{$O512437967[1]}\57\x6d\x61\170\x72\145\163\x64\145\146\141\x75\154\164\56\152\160\147";
        O334848913:
        return $O087924992;
    }
    function processUpload(string $O638507307 = '', ?callable $O971671176 = null, int $O646476269 = 0, bool $O412463941 = true, bool $O322129326 = false, array $O659383028 = [], int $O672542244 = 0) : ?array
    {
        $O421948702 = true;
        if ($O638507307) {
            goto O599522115;
        }
        $O638507307 = "\155\145\x64\151\x61\57" . date("\131\x2d\x6d");
        O599522115:
        $O563567060 = \Web::instance();
        $O996384361 = $O563567060->receive(function ($O278385465, $O439564963) use($O672542244) {
            return $O672542244 && $O278385465["\x73\x69\x7a\x65"] > $O672542244 ? false : true;
        }, $O421948702, function ($O544492204, $O439564963) {
            return "{$O439564963}\x5f\x5f{$O544492204}";
        });
        $O473483731 = [];
        foreach ($O996384361 as $O278385465 => $O813242731) {
            goto O545666503;
            O545666503:
            if (!$O813242731) {
                goto O037389660;
            }
            $O673402283 = \Base::instance();
            $O852696172 = trim($O638507307, "\x2f");
            $O904747538 = $O673402283["\122\117\x4f\x54"] . $O673402283["\102\x41\x53\105"] . "\x2f" . $O852696172;
            if (is_dir($O904747538)) {
                goto O475227141;
            }
            mkdir($O904747538, 0777, true);
            chmod($O904747538, 0777);
            O475227141:
            goto O933275829;
            O722505229:
            if (!$O659383028) {
                goto O106860997;
            }
            $O670548386->copyfrom($O659383028);
            O106860997:
            $O670548386->save();
            $O891892174["\x69\144"] = $O670548386->lastInsertId();
            O569770876:
            $O891892174["\155\x65\164\141"] = $O693475296;
            $O473483731[] = $O891892174 + (array) $O659383028;
            goto O046305432;
            O606291909:
            O653334179:
            $O144303611 = filesize($O908414053);
            $O705606430 = function ($O594429753, $O729885551 = 2) {
                $O642505268 = "\102\113\115\x47\124\x50";
                $O156768679 = floor((strlen($O594429753) - 1) / 3);
                return sprintf("\45\x2e{$O729885551}\x66", $O594429753 / pow(1024, $O156768679)) . @$O642505268[$O156768679];
            };
            [$O000415445, $O817755661] = explode("\x5f\137", $O817755661, 2);
            $O891892174 = ["\156\141\155\x65" => $O817755661, "\146\x69\145\x6c\x64" => $O000415445, "\x75\x72\154" => "{$O852696172}\57{$O331552916}", "\x64\x6f\167\x6e\x6c\x6f\x61\x64\x6b\x65\171" => strrev(guidv4())];
            $O693475296 = ["\x6f\162\x69\147\x69\156" => $O817755661, "\165\162\154" => $O673402283["\x52\117\117\124\x5f\125\122\114"] . "\57{$O852696172}\57{$O331552916}", "\x73\151\172\x65" => $O144303611, "\150\163\151\172\145" => $O705606430($O144303611), "\x65\170\x74" => $O268049873];
            if (!is_callable($O971671176)) {
                goto O858768495;
            }
            $O119544028 = call_user_func($O971671176, $O891892174);
            goto O454392992;
            O871075733:
            imagepalettetotruecolor($O087924992);
            imagealphablending($O087924992, true);
            imagesavealpha($O087924992, true);
            O565757246:
            imagewebp($O087924992, $O908414053, 75);
            unlink($O816445333);
            $O268049873 = "\167\x65\142\x70";
            O448257987:
            goto O606291909;
            O179671425:
            if ($O499951502 = $O297433309["\x6d\151\155\x65"] == "\x69\155\x61\x67\145\57\x67\x69\146") {
                goto O434574167;
            }
            if ($O499951502 = $O297433309["\x6d\x69\x6d\x65"] == "\151\155\141\x67\145\x2f\x70\x6e\x67") {
                goto O215786071;
            }
            $O087924992 = false;
            goto O504036986;
            O087335267:
            $O087924992 = imagecreatefromjpeg($O816445333);
            goto O504036986;
            O434574167:
            goto O804090568;
            O804090568:
            $O087924992 = imagecreatefromgif($O816445333);
            goto O504036986;
            O215786071:
            $O087924992 = imagecreatefrompng($O816445333);
            O504036986:
            if ($O087924992) {
                goto O926416273;
            }
            $O908414053 = "{$O904747538}\x2f{$O331552916}";
            rename($O816445333, $O908414053);
            goto O177253254;
            O177253254:
            goto O448257987;
            O926416273:
            $O331552916 = "{$O780197847}\56\x77\145\142\160";
            $O908414053 = "{$O904747538}\57{$O331552916}";
            if (!($O646476269 && $O646476269 < imagesx($O087924992))) {
                goto O902836087;
            }
            $O087924992 = imagescale($O087924992, $O646476269);
            O902836087:
            if (!$O499951502) {
                goto O565757246;
            }
            goto O871075733;
            O454392992:
            if (!$O119544028) {
                goto O420253035;
            }
            $O693475296 = array_merge($O693475296, $O119544028);
            O420253035:
            O858768495:
            $O891892174["\155\x65\164\x61"] = json_encode($O693475296, JSON_PRETTY_PRINT);
            if (!$O322129326) {
                goto O569770876;
            }
            $O670548386 = m("\134\106\x75\167\x61\x66\165\x77\141\134\115\x6f\144\x65\x6c\134\115\145\x64\151\x61");
            $O670548386->copyFrom($O891892174);
            goto O722505229;
            O046305432:
            O037389660:
            O070322336:
            goto O649937296;
            O933275829:
            $O817755661 = basename($O278385465);
            $O297433309 = pathinfo($O817755661);
            $O971388946 = str_split(uniqid() . sprintf("\x25\60\x33\x64", time() % 1000), 4);
            shuffle($O971388946);
            $O780197847 = strrev(join("\137", $O971388946));
            $O331552916 = $O780197847 . "\x2e" . $O297433309["\145\x78\x74\x65\156\x73\x69\x6f\156"];
            $O268049873 = $O297433309["\145\x78\x74\x65\156\163\151\x6f\156"];
            $O816445333 = $O673402283["\x52\117\117\124"] . $O673402283["\x42\101\123\x45"] . "\57" . $O673402283["\125\x50\x4c\x4f\101\x44\x53"] . $O817755661;
            goto O200506720;
            O200506720:
            if ($O412463941) {
                goto O627625735;
            }
            $O908414053 = "{$O904747538}\x2f{$O331552916}";
            rename($O816445333, $O908414053);
            goto O653334179;
            O627625735:
            $O297433309 = getimagesize($O816445333);
            $O499951502 = false;
            if ($O297433309["\x6d\151\155\x65"] == "\151\155\x61\x67\x65\57\x6a\x70\145\147") {
                goto O087335267;
            }
            goto O179671425;
            O649937296:
        }
        O180488844:
        return $O473483731;
    }
    function streamFile(?string $O745697976)
    {
        goto O727212534;
        O357302746:
        header("\103\157\x6e\164\x65\156\x74\55\x4c\145\156\x67\x74\150\x3a\x20" . $O432193560);
        header("\103\157\156\x6e\145\143\x74\151\157\156\x3a\x20\x63\x6c\x6f\163\x65");
        $O278385465 = fopen($O768528466, "\162\x62");
        O858326302:
        if (feof($O278385465)) {
            goto O409248478;
        }
        echo fread($O278385465, 1024);
        goto O858326302;
        O409248478:
        goto O505297295;
        O505297295:
        fclose($O278385465);
        exit;
        goto O531926796;
        O727212534:
        if ($O745697976) {
            goto O926945099;
        }
        die("\x45\162\x72\157\x72\x3a\40\x65\x6d\160\x74\171\x20\x64\157\167\156\154\157\x61\144\40\153\145\x79");
        O926945099:
        $O670548386 = m("\x5c\x46\165\x77\x61\x66\x75\167\x61\x5c\x4d\157\x64\145\x6c\134\x4d\x65\144\151\x61");
        $O670548386->load(["\144\x6f\x77\156\154\x6f\x61\x64\153\145\x79\40\x3d\40\77", $O745697976]);
        if (!$O670548386->dry()) {
            goto O276777483;
        }
        die("\105\162\162\157\162\72\40\106\151\x6c\x65\40\x6e\x6f\164\x20\x66\x6f\165\156\x64");
        O276777483:
        goto O815612817;
        O815612817:
        $O768528466 = $O670548386->url;
        $O693475296 = json_decode($O670548386["\155\x65\x74\141"]);
        function getMimeType($O768528466)
        {
            $O364836622 = pathinfo($O768528466, PATHINFO_EXTENSION);
            switch ($O364836622) {
                case "\x70\x64\x66":
                    return "\x61\x70\160\x6c\151\x63\x61\x74\151\x6f\156\x2f\x70\144\x66";
                case "\160\x6e\147":
                    return "\x69\x6d\141\x67\145\57\160\156\x67";
                case "\x6a\160\147":
                case "\x6a\x70\x65\x67":
                    return "\151\155\x61\x67\145\57\152\x70\x67";
                case "\x77\145\142\x70":
                    return "\x69\155\141\147\x65\x2f\x77\145\142\x70";
                case "\170\154\163":
                case "\x78\154\x73\170":
                    return "\x61\160\160\154\151\x63\x61\164\x69\157\156\x2f\166\x6e\144\56\x6d\x73\x2d\x65\170\143\145\x6c";
                default:
                    return "\x61\x70\x70\154\x69\x63\141\x74\151\x6f\x6e\x2f\x6f\x63\x74\145\x74\x2d\x73\x74\162\145\x61\155";
            }
            O551802813:
            O065172266:
        }
        $O495178245 = $O670548386->name;
        $O432193560 = $O693475296->size;
        $O038870134 = getMimeType($O768528466);
        header("\103\x6f\156\x74\145\x6e\x74\55\x54\x79\160\145\x3a\40" . $O038870134);
        header("\x43\x6f\x6e\164\145\x6e\x74\55\x44\x69\x73\x70\157\x73\x69\x74\151\x6f\x6e\72\x20\x69\x6e\x6c\x69\156\x65\x3b\x20\146\x69\154\145\x6e\141\x6d\x65\75\42" . $O495178245 . "\x22");
        goto O357302746;
        O531926796:
    }
    function deleteFile(?string $O745697976)
    {
        if ($O745697976) {
            goto O362908431;
        }
        return $this->jsonResult(false, "\x45\x6d\x70\x74\x79\x20\144\x6f\x77\156\x6c\157\x61\x64\40\153\x65\171");
        O362908431:
        $O670548386 = m("\x5c\106\165\x77\x61\146\x75\167\x61\134\115\x6f\144\145\154\134\x4d\145\x64\151\141");
        $O670548386->load(["\144\x6f\x77\156\154\157\141\144\x6b\145\171\x20\x3d\40\77", $O745697976]);
        if ($O670548386->dry()) {
            goto O353191149;
        }
        $O670548386->erase();
        return $this->jsonResult(true, "\x46\x69\154\x65\40\x64\145\x6c\x65\x74\145\x64");
        goto O386777512;
        O353191149:
        return $this->jsonResult(false, "\104\157\x77\156\154\x6f\x61\144\40\x4b\145\171\x20\x69\163\40\x6e\157\164\40\x66\157\165\156\x64");
        O386777512:
    }
    protected function retrieveCache(string $O259079837, bool $O863236222 = false) : void
    {
        $O703627848 = \Cache::instance();
        $O259079837 = safe_key($O259079837) . "\56\x74\170\164";
        if (!$O863236222) {
            goto O587679409;
        }
        $O703627848->clear($O259079837);
        O587679409:
        if (!($O891892174 = $O703627848->get($O259079837))) {
            goto O240307246;
        }
        die($O891892174);
        O240307246:
    }
    protected function jsonResult(bool $O305856284, $O050491992, ?array $O318852266 = null) : array
    {
        return ["\x73\165\x63\x63\145\163\163" => $O305856284, "\x6d\x65\163\x73\x61\x67\x65" => (array) $O050491992, "\144\141\x74\x61" => (array) $O318852266];
    }
    protected function jsonResponse(bool $O305856284, $O050491992, ?array $O318852266 = null) : void
    {
        $O891892174 = $this->jsonResult($O305856284, $O050491992, $O318852266);
        $this->sendJson($O891892174);
    }
    protected function sendJson(array $O318852266) : void
    {
        header("\103\157\x6e\164\145\x6e\x74\x2d\x74\171\160\145\x3a\40\141\160\160\154\x69\143\141\164\151\x6f\156\x2f\152\163\157\156");
        print json_encode($O318852266, JSON_UNESCAPED_UNICODE);
    }
}

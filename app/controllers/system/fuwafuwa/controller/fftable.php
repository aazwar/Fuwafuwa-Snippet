<?php
/*   __________________________________________________
    |  Obfuscated by YAK Pro - Php Obfuscator  2.0.14  |
    |              on 2024-08-02 12:47:57              |
    |    GitHub: https://github.com/pk-fr/yakpro-po    |
    |__________________________________________________|
*/

namespace Fuwafuwa\Controller;

use Throwable;
class FFTable implements Controller
{
    use \Fuwafuwa\Traits\SQL;
    use \Fuwafuwa\Traits\Content;
    const ADD = "\141\x64\x64";
    const EDIT = "\x65\144\151\164";
    const DEL = "\x64\x65\x6c";
    const VIEW = "\166\x69\x65\x77";
    protected array $data;
    protected $allowAdd;
    protected $allowEdit;
    protected $allowDel;
    function __construct()
    {
        $O673402283 = \Base::instance();
        $this->data = json_decode($O673402283["\x42\x4f\104\131"], true) ?? $O673402283["\x52\105\x51\x55\105\123\124"] ?? [];
        $this->allowAdd = fn(array $O318852266): bool => true;
        $this->allowEdit = fn(array $O318852266): bool => true;
        $this->allowDel = fn(array $O318852266): bool => true;
    }
    function arrayOf(Throwable $O304253321)
    {
        return ["\155\145\x73\x73\x61\x67\145" => $O304253321->getMessage(), "\143\x6f\x64\x65" => $O304253321->getCode(), "\146\x69\154\145" => $O304253321->getFile(), "\x6c\x69\156\145" => $O304253321->getLine(), "\164\162\x61\143\145" => $O304253321->getTraceAsString()];
    }
    function execute(\Base $O673402283, string $O573311338 = '') : void
    {
        header("\103\157\x6e\164\145\x6e\164\55\164\171\x70\145\x3a\40\x61\x70\x70\x6c\x69\143\x61\x74\151\157\156\57\152\x73\157\x6e\73\143\150\141\x72\x73\145\x74\75\165\164\146\55\70");
        if (method_exists($this, $O573311338)) {
            goto O683256735;
        }
        $O673402283->error(404);
        goto O632552808;
        O683256735:
        $this->{$O573311338}($O673402283);
        O632552808:
    }
    final function ajaxEdit(string|\Fuwafuwa\BaseModel $O947097333, string $O149467142 = '') : void
    {
        goto O524702468;
        O524702468:
        $O318852266 = $this->data["\144\x61\x74\141"];
        $O454769776 = $this->data["\157\160\x65\x72"];
        $O523254158 = $this->data["\x63\163\162\146"] ?? '';
        if (is_string($O947097333)) {
            goto O792312599;
        }
        $O437178018 = $O947097333;
        goto O676787907;
        O792312599:
        $O437178018 = m($O947097333);
        goto O568559959;
        O832382979:
        switch ($O454769776) {
            case static::ADD:
                goto O191604691;
                O790444512:
                $O891892174["\x64\x61\164\141"] = array_intersect_key($O437178018->cast(), array_flip(array_keys($O318852266)));
                goto O984290936;
                O345986473:
                $O891892174["\x73\x75\x63\143\x65\x73\x73"] = false;
                $O259079837 = join("\x2c\40", $O442320521);
                $O891892174["\x6d\x65\163\163\141\147\145"] = t("\x64\x62\x2e\144\165\160\154\x69\x63\x61\164\145\137\x72\145\143\x6f\162\144", $O437178018->table(), $O259079837);
                O984290936:
                O673349287:
                goto O173967558;
                O191604691:
                $O911318453 = call_user_func($this->allowAdd, $O318852266);
                if ($O911318453 === true) {
                    goto O878465926;
                }
                $O891892174["\163\165\x63\x63\145\x73\163"] = false;
                $O891892174["\x6d\145\163\x73\141\147\x65"] = t("\144\x62\x2e\x61\144\144\x5f\x64\151\x73\x61\x62\x6c\x65\144", $O911318453);
                goto O673349287;
                O878465926:
                if (!$O437178018->dry()) {
                    goto O345986473;
                }
                $O437178018->copyfrom($O318852266);
                goto O775201789;
                O775201789:
                if (!$O437178018->validation) {
                    goto O153590632;
                }
                $O855324517 = $O437178018->validate($O454769776, $O318852266);
                if (!$O855324517->fails()) {
                    goto O085742799;
                }
                $O559328710 = $O855324517->errors()->firstOfAll();
                die(json_encode(["\163\165\143\143\145\x73\x73" => false, "\x6d\145\163\163\141\147\x65" => $O559328710], JSON_UNESCAPED_UNICODE));
                O085742799:
                O153590632:
                $O437178018->save();
                goto O483155321;
                O483155321:
                if ($O437178018->ai_field) {
                    goto O951611918;
                }
                $O437178018->retrieve($O437178018->pkValues());
                goto O190771331;
                O951611918:
                $O411317904 = $O437178018->lastInsertId();
                $O437178018->load(["{$O437178018->ai_field}\x20\75\x20\x3f", $O411317904]);
                O190771331:
                $O891892174["\155\x65\x73\163\141\x67\145"] = t("\144\x62\56\162\x65\143\x6f\162\144\x5f\163\141\166\x65\x64", ucwords($O437178018->table()));
                goto O790444512;
                O173967558:
                goto O424248491;
                goto O860674899;
                O860674899:
            case static::EDIT:
                goto O140765933;
                O140765933:
                $O255033475 = call_user_func($this->allowEdit, $O318852266);
                if ($O255033475 === true) {
                    goto O931798798;
                }
                $O891892174["\x73\x75\x63\x63\145\163\163"] = false;
                $O891892174["\155\145\x73\x73\x61\x67\x65"] = t("\x64\142\56\145\x64\151\164\x5f\144\x69\x73\x61\x62\154\x65\x64", $O255033475);
                goto O343517288;
                O931798798:
                $O437178018->copyfrom($O318852266);
                if (!$O437178018->validation) {
                    goto O297958184;
                }
                goto O697195823;
                O085588813:
                $O891892174["\144\141\164\x61"] = array_intersect_key($O437178018->cast(), array_flip(array_keys($O318852266)));
                O343517288:
                goto O424248491;
                goto O343180980;
                O697195823:
                $O855324517 = $O437178018->validate($O454769776, $O318852266);
                if (!$O855324517->fails()) {
                    goto O869121895;
                }
                $O559328710 = $O855324517->errors()->firstOfAll();
                die(json_encode(["\163\165\x63\x63\x65\x73\x73" => false, "\x6d\145\x73\x73\141\147\x65" => $O559328710], JSON_UNESCAPED_UNICODE));
                O869121895:
                O297958184:
                $O437178018->save();
                $O437178018->retrieve($O437178018->pkValues());
                goto O085588813;
                O343180980:
            case static::DEL:
                $O172755404 = call_user_func($this->allowDel, $O318852266);
                if ($O172755404 === true) {
                    goto O264088515;
                }
                $O891892174["\163\165\143\x63\x65\163\x73"] = false;
                $O891892174["\x6d\x65\x73\x73\x61\x67\x65"] = t("\144\142\x2e\144\145\x6c\145\x74\145\x5f\x64\151\163\x61\x62\x6c\x65\x64", $O172755404);
                goto O466911111;
                O264088515:
                $O437178018->erase();
                $O891892174["\x64\141\164\141"] = $O318852266;
                O466911111:
                goto O424248491;
            case static::VIEW:
                $O891892174["\144\141\x74\x61"] = $O437178018->cast();
                goto O424248491;
            default:
                goto O424248491;
        }
        O321545926:
        O424248491:
        print json_encode($O891892174, JSON_UNESCAPED_UNICODE);
        goto O135338470;
        O258304512:
        $O318852266 = $O437178018->preProcess($O318852266, $O454769776);
        O987011583:
        $O602431473 = $O437178018->pk();
        $O442320521 = [];
        foreach ($O602431473 as $O760291049) {
            $O442320521[] = $O318852266[$O760291049] ?? null;
            O913262250:
        }
        O426331840:
        $O437178018->retrieve($O442320521);
        $O891892174["\163\165\143\x63\145\x73\163"] = true;
        goto O832382979;
        O568559959:
        O676787907:
        if (!$O149467142) {
            goto O987780773;
        }
        $O673402283 = \Base::instance();
        if (!(!$O523254158 || $O523254158 != $O673402283["\123\x45\x53\x53\111\117\116\56\x63\x73\162\x66"])) {
            goto O048809518;
        }
        $O673402283->error(403, "\111\x6e\x76\141\154\x69\144\40\103\123\x52\x46\40\x74\x6f\x6b\145\156");
        O048809518:
        O987780773:
        if (!is_callable($O437178018->preProcess)) {
            goto O987011583;
        }
        goto O258304512;
        O135338470:
    }
    function limitClause()
    {
        $O481275016 = ["\163\151\172\145" => 30, "\160\157\x73" => 0];
        ["\x73\x69\172\x65" => $O144303611, "\160\157\x73" => $O197980361] = $this->data + $O481275016;
        $O128225742 = $O197980361 * $O144303611;
        return "\x20\114\111\x4d\x49\x54\40{$O144303611}\x20\117\x46\106\x53\x45\x54\40{$O128225742}\40";
    }
    function sortClause()
    {
        ["\x73\157\x72\x74" => $O696641870] = $this->data + ["\x73\x6f\x72\x74" => []];
        if (!$O696641870) {
            goto O550265752;
        }
        return "\40\117\122\x44\105\x52\x20\102\131\x20" . join("\54\40", array_map(fn($O303733380) => "{$O303733380["\143\157\x6c"]}\x20" . ($O303733380["\163\157\162\x74"] ?? "\141\x73\x63"), $O696641870)) . "\x20";
        O550265752:
        return null;
    }
    function searchClause(string $O008538485 = '') : array
    {
        goto O136457144;
        O136457144:
        ["\x73\x65\141\x72\x63\x68" => $O865592248, "\163\145\x61\162\143\150\141\142\154\x65" => $O084210115, "\x6c\x69\155\151\x74" => $O835270704, "\x66\151\154\164\x65\162" => $O270287008] = $this->data + ["\163\x65\141\162\x63\150" => '', "\163\x65\x61\x72\x63\150\141\x62\154\145" => [], "\154\x69\x6d\151\x74" => [], "\x66\x69\154\x74\145\x72" => []];
        $O891493069 = '';
        $O251059784 = '';
        $O117830673 = array_merge($O270287008, $O835270704);
        $O691845072 = [];
        if (!($O117830673 || $O008538485)) {
            goto O999914222;
        }
        $O503259346 = [];
        if (!$O008538485) {
            goto O913301345;
        }
        goto O621459779;
        O621459779:
        $O503259346[] = $O008538485;
        O913301345:
        foreach ($O117830673 as $O877262245) {
            goto O166254649;
            O988995703:
            goto O467821737;
            O231814995:
            $O503259346[] = "{$O315925551}\40\x4c\111\x4b\x45\40\77";
            $O691845072[] = "{$O117508431}\45";
            goto O467821737;
            O412006915:
            $O503259346[] = "{$O315925551}\x20\114\x49\x4b\105\40\x3f";
            $O691845072[] = "\45{$O117508431}";
            goto O373937172;
            O771559090:
            O594544215:
            O467821737:
            O922978245:
            goto O994048024;
            O655609196:
            goto O467821737;
            O239735375:
            $O053265840 = "\50" . implode("\x2c\x20", array_map(fn($O303733380) => escapeSQLString($O303733380), explode("\174", $O117508431))) . "\51";
            $O503259346[] = "{$O315925551}\x20\111\116\x20{$O053265840}";
            goto O467821737;
            O250193547:
            if (!$O848188972) {
                goto O822649363;
            }
            switch (strtolower($O927823018)) {
                case "\x3c":
                    $O503259346[] = "\x28{$O315925551}\40\x3c\40\77\40\117\122\40{$O315925551}\x20\x3e\x20\x3f\x29";
                    goto O080600959;
                case "\74\75":
                    $O503259346[] = "\50{$O315925551}\x20\74\75\x20\x3f\40\x4f\x52\x20{$O315925551}\x20\x3e\75\x20\x3f\x29";
                    goto O080600959;
                case "\x3e":
                    $O503259346[] = "\x28{$O315925551}\40\x3e\40\77\x20\x41\x4e\x44\40{$O315925551}\x20\x3c\x20\x3f\51";
                    goto O080600959;
                case "\x3e\75":
                    $O503259346[] = "\50{$O315925551}\40\76\x3d\40\77\x20\x41\116\104\x20{$O315925551}\x20\74\75\x20\x3f\x29";
                    goto O080600959;
                case "\x3d":
                    $O503259346[] = "\50{$O315925551}\40{$O927823018}\40\x3f\40\x4f\122\x20{$O315925551}\x20{$O927823018}\40\x3f\51";
                    goto O080600959;
                default:
                    $O503259346[] = "\50{$O315925551}\40{$O927823018}\40\x3f\x20\x41\116\x44\40{$O315925551}\x20{$O927823018}\x20\77\x29";
            }
            goto O162637912;
            O373937172:
            goto O467821737;
            O378806795:
            $O503259346[] = "{$O315925551}\40{$O927823018}";
            goto O467821737;
            O366694041:
            $O503259346[] = "{$O315925551}\x20\102\105\124\x57\x45\105\x4e\x20\x3f\x20\101\x4e\x44\40\x3f";
            $O691845072[] = $O117508431;
            $O691845072[] = $O848188972;
            goto O655609196;
            O166254649:
            ["\143\157\154" => $O315925551, "\x6f\160" => $O927823018, "\x76\141\x6c\165\145" => $O117508431, "\166\x61\x6c\x75\145\x32" => $O848188972] = $O877262245 + ["\143\x6f\x6c" => '', "\157\x70" => '', "\x76\x61\154\165\145" => '', "\166\x61\x6c\x75\x65\62" => ''];
            if (!(!$O315925551 || !$O927823018 || !$O117508431)) {
                goto O806890141;
            }
            goto O922978245;
            O806890141:
            if (preg_match("\57\136\50\154\151\153\145\x7c\143\x6f\156\164\x61\151\156\163\51\x24\x2f\151", $O927823018)) {
                goto O054052542;
            }
            if (preg_match("\57\x5e\163\164\141\x72\164\163\x3f\x24\x2f\151", $O927823018)) {
                goto O231814995;
            }
            if (preg_match("\57\136\145\156\x64\x73\x3f\x24\x2f\151", $O927823018)) {
                goto O412006915;
            }
            if (preg_match("\x2f\x5e\x49\123\40\50\x4e\x4f\124\x20\x29\x3f\116\125\114\x4c\x24\x2f\x69", $O927823018)) {
                goto O378806795;
            }
            goto O694224184;
            O694224184:
            if (preg_match("\x2f\136\x62\x65\164\x77\145\x65\x6e\44\x2f\x69", $O927823018)) {
                goto O366694041;
            }
            if (preg_match("\x2f\x5e\151\x6e\x24\x2f\151", $O927823018)) {
                goto O239735375;
            }
            if (preg_match("\x2f\136\50\74\x7c\74\75\174\76\x7c\x3e\75\x7c\75\174\x3c\76\x7c\x21\x3d\51\77\x24\x2f\x69", $O927823018)) {
                goto O250193547;
            }
            throw "\111\156\166\x61\x6c\151\144\x20\123\x51\x4c\40\157\x70\145\162\x61\164\157\162";
            goto O467821737;
            O054052542:
            $O503259346[] = "{$O315925551}\40\114\111\x4b\105\x20\x3f";
            $O691845072[] = "\45{$O117508431}\x25";
            goto O988995703;
            O162637912:
            O266987972:
            O080600959:
            $O691845072[] = $O117508431;
            $O691845072[] = $O848188972;
            goto O594544215;
            O822649363:
            $O503259346[] = "{$O315925551}\x20{$O927823018}\x20\x3f";
            $O691845072[] = $O117508431;
            goto O771559090;
            O994048024:
        }
        O168028159:
        $O891493069 = join("\40\101\x4e\104\40", $O503259346);
        O999914222:
        if (!($O865592248 && $O084210115)) {
            goto O712443891;
        }
        $O391051803 = [];
        goto O170091541;
        O170091541:
        foreach ($O084210115 as $O877262245) {
            if ($O877262245["\157\x70"] == "\x4c\111\113\105") {
                goto O171247449;
            }
            $O691845072[] = $O865592248;
            $O391051803[] = "{$O877262245["\x63\157\154"]}\x20{$O877262245["\x6f\160"]}\x20\77";
            goto O924269034;
            O171247449:
            $O691845072[] = "\x25{$O865592248}\x25";
            $O391051803[] = "{$O877262245["\x63\x6f\x6c"]}\40\x4c\x49\113\105\40\77";
            O924269034:
            O160413365:
        }
        O935137742:
        $O251059784 = join("\x20\117\122\40", $O391051803);
        O712443891:
        $O045035930 = join("\x20\x41\116\x44\x20", array_filter([$O891493069 ? "\x28{$O891493069}\x29" : '', $O251059784 ? "\50{$O251059784}\51" : ''], fn($O303733380) => $O303733380));
        if (!$O045035930) {
            goto O737500106;
        }
        $O045035930 = "\x20\127\110\105\x52\x45\x20{$O045035930}\40";
        O737500106:
        goto O548482977;
        O548482977:
        return [$O045035930, $O691845072];
        goto O758922678;
        O758922678:
    }
    protected function record_list(string $O796001594) : void
    {
        $O481275016 = ["\163\x69\172\x65" => 30, "\160\157\163" => 0, "\163\x6f\x72\164" => [], "\x66\151\145\154\144\163" => []];
        ["\163\x69\x7a\x65" => $O144303611, "\x70\157\x73" => $O197980361, "\163\x6f\x72\x74" => $O696641870, "\x66\151\145\x6c\144\x73" => $O755397105] = $this->data + $O481275016;
        $O988735025 = m($O796001594);
        $O270287008 = null;
        $O580111820 = [];
        if (!$O696641870) {
            goto O497814867;
        }
        $O580111820["\x6f\x72\144\145\162"] = substr($this->sortClause(), 10);
        O497814867:
        [$O270287008, $O607697907] = $this->searchClause($O988735025->softdeleteCond());
        if (!$O270287008) {
            goto O072525359;
        }
        $O270287008 = substr($O270287008, 6);
        O072525359:
        $O891892174 = $O988735025->paginate($O197980361, $O144303611, [$O270287008, ...$O607697907], $O580111820);
        $O891892174["\163\165\142\163\145\x74"] = array_map(fn($O303733380) => array_intersect_key($O303733380->cast(), array_flip($O755397105)), $O891892174["\x73\165\x62\x73\145\164"]);
        $this->jsonResponse(true, '', $O891892174);
    }
    protected function record_elist(string $O864688667, $O962924163, $O503259346 = '') : void
    {
        $O481275016 = ["\x73\151\172\x65" => 30, "\160\x6f\x73" => 0];
        ["\163\x69\172\x65" => $O144303611, "\160\x6f\163" => $O197980361] = $this->data + $O481275016;
        [$O865592248, $O607697907] = $this->searchClause($O503259346);
        $O864688667 .= $O865592248 . $this->sortClause() . $this->limitClause();
        $O309656867 = $this->SQL([$O864688667, ...$O607697907]);
        $O399050510 = $this->FSQL1(["{$O962924163}\x20{$O865592248}", ...$O607697907]);
        $O891892174 = ["\163\x75\x62\x73\x65\x74" => $O309656867, "\143\x6f\165\x6e\x74" => floor($O399050510 / $O144303611) + 1, "\x6c\151\x6d\151\x74" => $O144303611, "\160\157\x73" => $O197980361, "\164\x6f\x74\141\x6c" => $O399050510];
        $this->jsonResponse(true, '', $O891892174);
    }
}
